var w=n=>{throw TypeError(n)};var S=(n,t,e)=>t.has(n)||w("Cannot "+e);var i=(n,t,e)=>(S(n,t,"read from private field"),e?e.call(n):t.get(n)),p=(n,t,e)=>t.has(n)?w("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),x=(n,t,e,s)=>(S(n,t,"write to private field"),s?s.call(n,e):t.set(n,e),e),E=(n,t,e)=>(S(n,t,"access private method"),e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function e(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(a){if(a.ep)return;a.ep=!0;const o=e(a);fetch(a.href,o)}})();const b={p1:.1,p2:.15,p3:.2,p4:.05,p5:.25,TUESDAY:.1,BULK:.25},B=30,$=5,K={TUESDAY:2},C=[{id:"p1",name:"상품1",val:1e4,quantity:50},{id:"p2",name:"상품2",val:2e4,quantity:30},{id:"p3",name:"상품3",val:3e4,quantity:20},{id:"p4",name:"상품4",val:15e3,quantity:0},{id:"p5",name:"상품5",val:25e3,quantity:10}];function _(n){const t=document.createElement("div");return t.id=n.id,t.className="flex justify-between items-center mb-2",t.innerHTML="<span>"+n.name+" - "+n.val+'원 x 1</span><div><button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="'+n.id+'" data-change="-1">-</button><button class="quantity-change bg-blue-500 text-white px-2 py-1 rounded mr-1" data-product-id="'+n.id+'" data-change="1">+</button><button class="remove-item bg-red-500 text-white px-2 py-1 rounded" data-product-id="'+n.id+'">삭제</button></div>',t}function k(n,t){if(!n)return;const e=n.dataset.productId,s=document.getElementById(e),a=t.find(o=>o.id===e);return{$product:s,product:a}}function Y(n,t){if(!n)return;const e=_(t);n.appendChild(e),t.quantity--}function F(n,t){const e=parseInt(n.querySelector("span").textContent.split("x ")[1])+1;e<=t.quantity?(n.querySelector("span").textContent=t.name+" - "+t.val+"원 x "+e,t.quantity--):alert("재고가 부족합니다.")}function L(n,t,e){const{discountedPrice:s,totalQuantity:a,totalPrice:o}=H(t);let r=0;r=j(a,s,o),n.textContent="총액: "+Math.round(s)+"원",V(n,r),W(e),X(n,s)}function H(n){let t=0,e=0,s=0;const a=n.children;for(const o of a){const r=o.id,q=C.find(Q=>Q.id===r),y=parseInt(o.querySelector("span").textContent.split("x ")[1]);y>0&&(e+=y);const I=q.val*y;I>0&&(s+=I);let P=0;y>=10&&(P=Z(r)),t+=I*(1-P)}return{discountedPrice:t,totalQuantity:e,totalPrice:s}}function j(n,t,e){let s=0;return typeof n!="number"||typeof t!="number"||n===0||t===0||e===0?0:(s=G(t,e),n>=B&&(s=z(n,t,e)),s=J(t,s),s)}function G(n,t){return(t-n)/t}function z(n,t,e){let s=0;if(n>=B){const a=t*b.BULK,o=e-t;a>o&&(t=e*(1-b.BULK),s=b.BULK)}return s}function J(n,t){let e=t;return new Date().getDay()===K.TUESDAY&&(e=Math.max(t,b.TUESDAY)),e}function V(n,t){if(t>0){var e=document.createElement("span");e.className="text-green-500 ml-2",e.textContent="("+(t*100).toFixed(1)+"% 할인 적용)",n.appendChild(e)}}function W(n){var t="";C.forEach(e=>{e.quantity<$&&(t+=e.name+": "+(e.quantity>0?"재고 부족 ("+e.quantity+"개 남음)":"품절")+`
`)}),n.textContent=t}function X(n,t){const e=Math.floor(t/1e3);var s=document.getElementById("loyalty-points");s||(s=document.createElement("span"),s.id="loyalty-points",s.className="text-blue-500 ml-2",n.appendChild(s)),s.textContent="(포인트: "+e+")"}function Z(n){return b[n]||0}var d,l,h,f,m,v,u,g,c,D,M,T,A,R,O;class tt{constructor(t){p(this,c);p(this,d);p(this,l);p(this,h);p(this,f);p(this,m);p(this,v);p(this,u);p(this,g);this.rootId=t,i(this,d),i(this,l),i(this,h),i(this,f),i(this,m),i(this,v),i(this,u),i(this,g),this.lastSelectedProductId}render(){E(this,c,D).call(this),E(this,c,T).call(this),E(this,c,M).call(this),E(this,c,A).call(this),E(this,c,R).call(this),E(this,c,O).call(this)}}d=new WeakMap,l=new WeakMap,h=new WeakMap,f=new WeakMap,m=new WeakMap,v=new WeakMap,u=new WeakMap,g=new WeakMap,c=new WeakSet,D=function(){x(this,d,document.createElement("div")),x(this,l,document.createElement("div")),x(this,h,document.createElement("select")),x(this,f,document.createElement("button")),x(this,m,document.createElement("div")),x(this,v,document.createElement("div")),x(this,u,document.createElement("div")),x(this,g,document.createElement("h1"))},M=function(){i(this,l).textContent="총액: 0원(포인트: 0)",i(this,g).textContent="장바구니"},T=function(){i(this,d).id="cart-items",i(this,l).id="cart-total",i(this,h).id="product-select",i(this,f).id="add-to-cart",i(this,m).id="stock-status",i(this,l).className="text-xl font-bold my-4",i(this,h).className="border rounded p-2 mr-2",i(this,f).className="bg-blue-500 text-white px-4 py-2 rounded",i(this,m).className="text-sm text-gray-500 mt-2",i(this,f).textContent="추가",i(this,v).className="bg-gray-100 p-8",i(this,u).className="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl p-8",i(this,g).className="text-2xl font-bold mb-4"},A=function(){i(this,h).innerHTML="",C.forEach(t=>{const e=document.createElement("option");e.value=t.id,e.textContent=t.name+" - "+t.val+"원",t.quantity===0&&(e.disabled=!0),i(this,h).appendChild(e)})},R=function(){i(this,u).appendChild(i(this,g)),i(this,u).appendChild(i(this,d)),i(this,u).appendChild(i(this,l)),i(this,u).appendChild(i(this,h)),i(this,u).appendChild(i(this,f)),i(this,u).appendChild(i(this,m)),i(this,v).appendChild(i(this,u)),document.getElementById(this.rootId).appendChild(i(this,v))},O=function(){i(this,f).addEventListener("click",()=>{const t=i(this,h).value,e=C.find(a=>a.id===t);if(!e||e.quantity<1)return;const s=document.getElementById(e.id);s?F(s,e):Y(i(this,d),e),L(i(this,l),i(this,d),i(this,m)),this.lastSelectedProductId=t}),i(this,d).addEventListener("click",t=>{const e=t.target;if(!e.classList.contains("quantity-change")&&!e.classList.contains("remove-item"))return;const s=e.dataset.productId,a=document.getElementById(s),o=C.find(r=>r.id===s);if(e.classList.contains("quantity-change")){const r=parseInt(e.dataset.change),q=parseInt(a.querySelector("span").textContent.split("x ")[1]),y=q+r;y>0&&y<=o.quantity+q?(a.querySelector("span").textContent=o.name+" - "+o.val+"원 x "+y,o.quantity-=r):y<=0?(a.remove(),o.quantity-=r):alert("재고가 부족합니다.")}else if(e.classList.contains("remove-item")){const r=parseInt(a.querySelector("span").textContent.split("x ")[1]);o.quantity+=r,a.remove()}L(i(this,l),i(this,d),i(this,m))}),i(this,d).addEventListener("click",t=>{const e=t.target;if(!e.classList.contains("remove-item"))return;const{$product:a,product:o}=k(e,C);if(!a||!o)return;const r=parseInt(a.querySelector("span").textContent.split("x ")[1]);o.quantity+=r,a.remove(),L(i(this,l),i(this,d),i(this,m))})};function U(n,t){return setTimeout(()=>n,t)}function et(n){U(setInterval(function(){const t=n[Math.floor(Math.random()*n.length)];Math.random()<.3&&t.q>0&&(t.val=Math.round(t.val*.8),alert("번개세일! "+t.name+"이(가) 20% 할인 중입니다!"))},3e4),Math.random()*1e4)}function nt(n,t){U(setInterval(function(){if(n){const e=t.find(function(s){return s.id!==n&&s.q>0});e&&(alert(e.name+"은(는) 어떠세요? 지금 구매하시면 5% 추가 할인!"),e.val=Math.round(e.val*.95))}},6e4),Math.random()*2e4)}function it(n){et(C),nt(n,C)}const N=new tt("app");function st(){N.render(),it(N.lastSelectedProductId)}st();
